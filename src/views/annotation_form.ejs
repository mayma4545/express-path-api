<%- include('partials/header', { title: (typeof annotation !== 'undefined' && annotation ? 'Edit Annotation' : 'Create Annotation') + ' - Campus Navigation' }) %>

<div class="page-header">
    <h1><%= typeof annotation !== 'undefined' && annotation ? '✏️ Edit Annotation' : '➕ Create Annotation' %></h1>
    <a href="/annotations" class="btn-secondary">← Back to Annotations</a>
</div>

<div class="form-container">
    <form action="<%= typeof annotation !== 'undefined' && annotation ? '/annotations/' + annotation.id + '/edit' : '/annotations/create' %>" method="POST" class="styled-form">
        
        <div class="form-group">
            <label for="node_id">Node *</label>
            <select id="node_id" name="node_id" required>
                <option value="">Select a node...</option>
                <% nodes.forEach(function(node) { %>
                    <option value="<%= node.id %>" <%= (typeof annotation !== 'undefined' && annotation && annotation.node_id === node.id) ? 'selected' : '' %>>
                        <%= node.name %> (<%= node.building || 'No building' %>)
                    </option>
                <% }); %>
            </select>
        </div>

        <div class="form-group">
            <label for="label">Label *</label>
            <input type="text" id="label" name="label" value="<%= typeof annotation !== 'undefined' && annotation ? annotation.label : '' %>" required>
            <p class="help-text">The text that will be displayed on the 360° panorama</p>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="yaw">Yaw (horizontal angle)</label>
                <input type="number" id="yaw" name="yaw" step="0.01" value="<%= typeof annotation !== 'undefined' && annotation ? (annotation.yaw || 0) : 0 %>">
                <p class="help-text">Horizontal position in degrees (-180 to 180)</p>
            </div>
            <div class="form-group">
                <label for="pitch">Pitch (vertical angle)</label>
                <input type="number" id="pitch" name="pitch" step="0.01" value="<%= typeof annotation !== 'undefined' && annotation ? (annotation.pitch || 0) : 0 %>">
                <p class="help-text">Vertical position in degrees (-90 to 90)</p>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn-primary"><%= typeof annotation !== 'undefined' && annotation ? 'Update Annotation' : 'Create Annotation' %></button>
            <a href="/annotations" class="btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<%- include('partials/footer') %>
